# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  vmImage: ubuntu-latest

stages:
  - stage: build
    jobs:
      - job: Firstjob
        steps:
          - bash: echo build Firstjob
          - bash: echo $(pipeline-variable)
          - bash: echo $(System.DefaultWorkingDirectory)
          - bash: echo $(Build.ArtifactStagingDirectory)
          - bash: node --version
          - task: CopyFiles@2
            inputs:
              SourceFolder: '$(System.DefaultWorkingDirectory)'
              Contents: |
                **/*yaml
                **/*tf
              TargetFolder: '$(Build.ArtifactStagingDirectory)'
      - job: secondJob
        steps:
          - bash: echo build secondJob
  - stage: Devdeploy
    variables:
      environment: Dev
    dependsOn: build
    jobs:
      - job: Devdeploy
        steps:
          - bash: echo build Devdeploy
          - bash: echo $(environment)
  - stage: QAdeploy
    variables:
      environment: Dev
    dependsOn: build
    jobs:
      - job: QAdeploy
        steps:
          - bash: echo build QAdeploy
          - bash: echo $(environment)
  - stage: ProdDeploy
    variables:
      environment: Dev
    dependsOn: 
    - Devdeploy
    - QAdeploy
    jobs:
      - job: ProdDeploy
        steps:
          - bash: echo build ProdDeploy
          - bash: echo $(environment)
    

